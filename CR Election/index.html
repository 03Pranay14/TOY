<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picker Wheel - Random Decision Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3b82f6;
            --bg-color: #f0f2f5;
            --sidebar-bg: #ffffff;
            --text-color: #333;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* NAVBAR */
        .navbar {
            background: #fff;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            z-index: 100;
        }
        .logo {
            font-weight: 900;
            font-size: 1.2rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .logo span { color: #e11d48; }

        /* MAIN LAYOUT */
        .main-container {
            display: flex;
            flex: 1;
            height: 100%;
        }

        /* LEFT SIDE: WHEEL */
        .wheel-section {
            flex: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: #ecf0f1; /* Subtle pattern bg could go here */
        }

        .wheel-wrapper {
            position: relative;
            width: 500px;
            height: 500px;
            max-width: 90vw;
            max-height: 90vw;
        }

        #wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 12px solid #fff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            transform: rotate(0deg);
            position: relative;
            overflow: hidden;
        }

        /* The Triangle Pointer */
        .pointer {
            position: absolute;
            top: -5px; /* Adjust to overlap border slightly */
            right: -25px; /* Right side pointer like PickerWheel */
            top: 50%;
            transform: translateY(-50%) rotate(-90deg);
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 35px solid #333;
            z-index: 20;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
        }
        
        /* Note: Original pickerwheel usually has pointer on the right. 
           We need to rotate text logic if we move pointer. 
           Let's stick to TOP pointer for code stability, but style it to look cool. */
        .pointer-top {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-top: 40px solid #ffffff; /* White border look */
            z-index: 20;
        }
        .pointer-inner {
            position: absolute;
            top: -42px;
            left: -15px;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #333;
        }

        /* CENTER SPIN BUTTON */
        .center-hub {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 80px; height: 80px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 4px solid #e2e8f0;
            transition: 0.2s;
        }
        .center-hub:hover { transform: translate(-50%, -50%) scale(1.05); }
        .center-hub:active { transform: translate(-50%, -50%) scale(0.95); }
        
        .spin-text {
            font-weight: 800;
            color: #333;
            font-size: 1.2rem;
            user-select: none;
        }

        .wheel-label {
            position: absolute;
            top: 50%; left: 50%;
            width: 50%; height: 20px;
            transform-origin: 0% 50%;
            text-align: right;
            padding-right: 50px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
            line-height: 20px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* RIGHT SIDE: INPUTS */
        .sidebar {
            flex: 1;
            background: var(--sidebar-bg);
            padding: 20px;
            display: flex;
            flex-direction: column;
            border-left: 1px solid #e5e7eb;
            min-width: 300px;
            max-width: 400px;
        }

        .tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        .tab { font-weight: 700; color: #3b82f6; cursor: pointer; }
        .tab.inactive { color: #9ca3af; }

        .input-area {
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 5px;
            display: flex;
            margin-bottom: 20px;
        }
        .input-area input {
            border: none;
            flex: 1;
            padding: 10px;
            outline: none;
            font-size: 1rem;
        }
        .add-btn {
            background: #eef2ff;
            color: #3b82f6;
            border: none;
            padding: 0 20px;
            font-weight: 700;
            cursor: pointer;
            border-radius: 6px;
        }
        .add-btn:hover { background: #e0e7ff; }

        .entries-list {
            flex: 1;
            overflow-y: auto;
        }
        .entry-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.95rem;
        }
        .entry-item:hover { background: #f9fafb; }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(2px);
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            animation: popIn 0.3s ease;
            position: relative;
            max-width: 400px;
            width: 90%;
        }
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .winner-title { font-size: 1.2rem; color: #6b7280; margin-bottom: 10px; }
        .winner-name { font-size: 3rem; font-weight: 900; color: #333; margin: 0; line-height: 1.2; }
        
        .modal-buttons {
            margin-top: 30px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .btn-modal {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }
        .btn-close { background: #f3f4f6; color: #333; }
        .btn-hide { background: #3b82f6; color: white; }

        /* Confetti */
        .confetti {
            position: absolute;
            width: 10px; height: 10px;
            background-color: #f00;
            animation: fall linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(720deg); }
        }

    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo">Picker<span>Wheel</span></div>
    </nav>

    <div class="main-container">
        <div class="wheel-section">
            <div class="wheel-wrapper">
                <div class="pointer-top">
                    <div class="pointer-inner"></div>
                </div>
                <div id="wheel"></div>
                
                <div class="center-hub" id="spinBtn" onclick="spinWheel()">
                    <span class="spin-text">SPIN</span>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="tabs">
                <div class="tab">Inputs</div>
                <div class="tab inactive">Tools</div>
            </div>
            
            <div class="input-area">
                <input type="text" id="nameInput" placeholder="Add name..." onkeypress="handleEnter(event)">
                <button class="add-btn" onclick="addName()">+</button>
            </div>

            <div style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>Entries</span>
                <span id="countDisplay">0</span>
            </div>

            <div class="entries-list" id="nameList">
                </div>
        </div>
    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <div class="winner-title">We have a winner!</div>
            <h1 class="winner-name" id="winnerText">Name</h1>
            <div class="modal-buttons">
                <button class="btn-modal btn-hide" onclick="closeModalAndEliminate()">Done</button>
            </div>
        </div>
    </div>

    <script>
        // --- RIGGED LOGIC ---
        let participants = [];
        let winnerQueue = [];    // Top 8
        let sarthakQueue = [];   // Sarthak
        let isSpinning = false;
        let globalRotation = 0;
        let slotsFilled = 0;     // Permanent Counter

        // PickerWheel Style Colors
        const colors = [
            "#3369e8", "#d50f25", "#eeb211", "#009925", 
            "#00b2cc", "#ff6d00", "#5e35b1", "#e91e63"
        ];

        function addName() {
            const input = document.getElementById('nameInput');
            const name = input.value.trim();
            if (!name) return;

            const isSarthak = name.toLowerCase() === "sarthak";

            // LOGIC:
            if (isSarthak) {
                sarthakQueue.push(name);
            } else if (slotsFilled < 8) {
                winnerQueue.push(name);
                slotsFilled++;
            }

            participants.push(name);
            input.value = "";
            renderUI();
        }

        function handleEnter(e) { if (e.key === "Enter") addName(); }

        function renderUI() {
            // Update List
            const list = document.getElementById('nameList');
            const count = document.getElementById('countDisplay');
            list.innerHTML = "";
            participants.forEach(p => {
                const div = document.createElement('div');
                div.className = 'entry-item';
                div.innerText = p;
                list.appendChild(div);
            });
            count.innerText = participants.length;

            // Update Wheel
            const wheel = document.getElementById('wheel');
            wheel.innerHTML = "";
            
            if (participants.length === 0) {
                wheel.style.background = "#fff";
                return;
            }

            const slice = 360 / participants.length;
            let gradientStr = "conic-gradient(";

            participants.forEach((name, i) => {
                const start = (i / participants.length) * 100;
                const end = ((i + 1) / participants.length) * 100;
                const color = colors[i % colors.length];
                gradientStr += `${color} ${start}% ${end}%,`;

                // Label
                const label = document.createElement('div');
                label.className = 'wheel-label';
                label.innerText = name;
                const angle = (slice * i) + (slice / 2) - 90; // -90 because 0deg is top
                label.style.transform = `rotate(${angle}deg)`;
                wheel.appendChild(label);
            });

            gradientStr = gradientStr.slice(0, -1) + ")";
            wheel.style.background = gradientStr;
        }

        function spinWheel() {
            if (isSpinning || participants.length === 0) return;

            // DETERMINE WINNER
            let winnerName = null;
            if (winnerQueue.length > 0) {
                // Priority 1: Top 8
                const r = Math.floor(Math.random() * winnerQueue.length);
                winnerName = winnerQueue[r];
            } else if (sarthakQueue.length > 0) {
                // Priority 2: Sarthak
                winnerName = sarthakQueue[0];
            } else {
                // Priority 3: Random leftovers
                const r = Math.floor(Math.random() * participants.length);
                winnerName = participants[r];
            }

            isSpinning = true;

            // CALCULATE MATH
            const visualIndex = participants.indexOf(winnerName);
            const sliceSize = 360 / participants.length;
            
            // Center of slice
            const centerAngle = (visualIndex * sliceSize) + (sliceSize / 2);
            
            // Add randomness (+/- 40% of slice)
            const variance = (Math.random() * sliceSize * 0.8) - (sliceSize * 0.4);
            
            // We want to land on (centerAngle + variance).
            // To bring that angle to the TOP (0deg), we rotate backwards by that amount.
            // Add spins (e.g. 8 spins = 2880 deg)
            const targetRotation = 2880 - (centerAngle + variance);

            // Handle cumulative rotation
            const currentMod = globalRotation % 360;
            globalRotation += targetRotation - currentMod; 
            // Ensure we are always adding positive rotation to spin CW
            if (globalRotation < 0) globalRotation += 36000;
            globalRotation += 3600; // Extra safety spins

            const wheel = document.getElementById('wheel');
            wheel.style.transform = `rotate(${globalRotation}deg)`;

            // WAIT FOR STOP
            setTimeout(() => {
                showResult(winnerName);
            }, 4000);
        }

        // --- MODAL & EFFECTS ---
        let currentWinner = null;

        function showResult(name) {
            currentWinner = name;
            document.getElementById('winnerText').innerText = name;
            document.getElementById('resultModal').style.display = 'flex';
            fireConfetti();
        }

        function closeModalAndEliminate() {
            document.getElementById('resultModal').style.display = 'none';
            
            // Eliminate Logic
            if (currentWinner) {
                participants = participants.filter(p => p !== currentWinner);
                winnerQueue = winnerQueue.filter(w => w !== currentWinner);
                sarthakQueue = sarthakQueue.filter(s => s !== currentWinner);
                renderUI();
            }
            
            isSpinning = false;
        }

        // --- CONFETTI HELPER ---
        function fireConfetti() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff'];
            for (let i = 0; i < 100; i++) {
                const conf = document.createElement('div');
                conf.className = 'confetti';
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.animationDuration = (Math.random() * 2 + 2) + 's';
                document.body.appendChild(conf);
                
                // Cleanup
                setTimeout(() => conf.remove(), 4000);
            }
        }
    </script>
</body>
</html>